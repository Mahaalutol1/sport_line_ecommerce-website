<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SportLine - Dashboard</title>
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap.min.css') }}">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="{{ url_for('static', filename='font-awesome.min.css') }}">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom Dashboard CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
    
    <style>
        body {
            background: #1a1a1a;
            font-family: 'Poppins', sans-serif;
            color: #fff;
            min-height: 100vh;
        }
        
        .dashboard-container {
            padding-top: 60px !important;
            padding-bottom: 2rem;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }
        
        .navbar {
            background: #1a1a1a;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 0;
            height: 80px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }
        
        .nav-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            height: 100%;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        .navbar-brand {
            display: none !important;
        }
        
        .navbar-brand img {
            height: 45px;
            width: auto;
        }

        .nav-links {
            display: flex;
            align-items: center;
            height: 100%;
            margin: 0;
            padding: 0;
            list-style: none;
        }
        
        .nav-item {
            height: 100%;
            display: flex;
            align-items: center;
        }
        
        .nav-link {
            color: rgba(255, 255, 255, 0.7) !important;
            padding: 0 1.5rem !important;
            height: 80px;
            display: flex;
            align-items: center;
            font-size: 1rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
            text-decoration: none;
        }
        
        .nav-link:hover {
            color: #fff !important;
            background: rgba(78, 79, 250, 0.1);
        }

        .nav-link.active {
            color: #fff !important;
            background: rgba(78, 79, 250, 0.1);
            position: relative;
        }

        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: #4e4ffa;
            border-radius: 3px 3px 0 0;
        }

        .nav-actions {
            display: flex;
            align-items: center;
            height: 100%;
            margin-left: auto;
        }

        .dashboard-link {
            color: #4e4ffa !important;
            border: 1px solid rgba(78, 79, 250, 0.3);
            border-radius: 6px;
            padding: 0.5rem 1.25rem !important;
            height: 40px;
            margin-right: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .dashboard-link:hover {
            background: rgba(78, 79, 250, 0.1);
            transform: translateY(-2px);
        }

        .dashboard-link.active {
            background: rgba(78, 79, 250, 0.15);
            color: #fff !important;
        }
        
        .logout-btn {
            color: #ff4444 !important;
            border: 1px solid rgba(255, 68, 68, 0.3);
            border-radius: 6px;
            padding: 0.5rem 1.25rem !important;
            height: 40px;
            font-weight: 500;
            transition: all 0.3s ease;
            background: transparent;
        }
        
        .logout-btn:hover {
            background: rgba(255, 68, 68, 0.1);
            transform: translateY(-2px);
        }

        .dashboard-header {
            margin-top: 0 !important;
            margin-bottom: 1.5rem;
            padding-top: 1rem !important;
            background: rgba(255, 255, 255, 0.05);
            padding: 30px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .dashboard-title {
            font-size: 2.5rem;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .dashboard-subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.2rem;
            font-weight: 300;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            border-color: rgba(78, 79, 250, 0.3);
        }
        
        .stat-title {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 15px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 600;
            color: #4e4ffa;
            margin: 0;
        }
        
        .content-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .content-card h2 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            font-weight: 600;
            color: #fff;
        }
        
        .content-card p {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .btn-primary {
            background: #4e4ffa;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: #0102fa;
            transform: translateY(-2px);
        }

        .navbar-toggler {
            border-color: rgba(255, 255, 255, 0.1);
        }

        .navbar-toggler-icon {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(255, 255, 255, 0.7)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
        }

        @media (max-width: 991.98px) {
            .navbar {
                height: auto;
                padding: 1rem 0;
            }
            
            .nav-container {
                flex-direction: column;
                align-items: flex-start;
                padding: 0 1rem;
            }
            
            .navbar-brand {
                margin-bottom: 1rem;
                height: 60px;
            }
            
            .nav-links {
                flex-direction: column;
                width: 100%;
                height: auto;
            }
            
            .nav-item {
                width: 100%;
                height: auto;
            }
            
            .nav-link {
                width: 100%;
                padding: 0.75rem 1rem !important;
                height: auto;
                justify-content: center;
            }

            .nav-actions {
                width: 100%;
                flex-direction: column;
                gap: 0.5rem;
                margin-top: 0.5rem;
            }

            .dashboard-link,
            .logout-btn {
                width: 100%;
                justify-content: center;
                margin: 0;
                text-align: center;
            }
            
            .dashboard-container {
                padding-top: 40px !important;
            }
        }
        
        .chart-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 30px;
        }
        
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .action-card {
            background: rgba(33, 33, 33, 0.6);
            border-radius: 10px;
            padding: 30px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 160px;
            position: relative;
            overflow: hidden;
        }
        
        .action-card:hover {
            transform: translateY(-5px);
            background: rgba(33, 33, 33, 0.8);
            border-color: rgba(78, 79, 250, 0.5);
        }

        .action-icon {
            font-size: 40px;
            margin-bottom: 20px;
            color: #4e4ffa;
            height: 50px;
            width: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 1;
        }

        .action-icon::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            background: rgba(78, 79, 250, 0.15);
            border-radius: 50%;
            z-index: -1;
        }
        
        .action-title {
            font-size: 1.1rem;
            font-weight: 500;
            color: #fff;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            z-index: 1;
        }
        
        .alert-section {
            background: rgba(220, 53, 69, 0.1);
            border: 1px solid rgba(220, 53, 69, 0.2);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .alert-title {
            color: #dc3545;
            font-weight: 600;
            font-size: 1.2rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .alert-title i {
            color: #dc3545;
        }

        .alert-section p {
            color: rgba(255, 255, 255, 0.7);
            margin: 0;
            font-size: 1.1rem;
        }
        
        .table-responsive {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 30px;
        }
        
        .dashboard-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1rem;
            background-color: #000000;
            color: #ffffff;
        }
        
        .dashboard-table th {
            background-color: #1a1a1a;
            color: #ffffff;
            padding: 12px;
            text-align: left;
            border-bottom: 2px solid #333333;
        }
        
        .dashboard-table td {
            padding: 12px;
            border-bottom: 1px solid #333333;
        }
        
        .dashboard-table tr:hover {
            background-color: #1a1a1a;
        }
        
        .dashboard-table .text-muted {
            color: #999999 !important;
        }
        
        .status-badge {
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .status-success {
            background-color: #28a745;
            color: #ffffff;
        }
        
        .status-warning {
            background-color: #ffc107;
            color: #000000;
        }
        
        .status-info {
            background-color: #17a2b8;
            color: #ffffff;
        }
        
        .status-danger {
            background-color: #dc3545;
            color: #ffffff;
        }
        
        .dashboard-card {
            background: #000000;
            border-radius: 8px;
            box-shadow: none;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            color: #ffffff;
        }
        
        .dashboard-card h2 {
            color: #ffffff;
            margin-bottom: 1rem;
        }
        
        .text-center {
            text-align: center;
        }
        
        .welcome-hero {
            margin-top: 0 !important;
            margin-bottom: 1.5rem;
            padding-top: 1rem !important;
            padding-bottom: 1.5rem !important;
            text-align: center;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }

        .hero-title {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: #fff;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .hero-subtitle {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 2rem;
            font-weight: 400;
        }

        @media (max-width: 768px) {
            .hero-title {
                font-size: 2rem;
            }

            .hero-subtitle {
                font-size: 1rem;
            }
        }

        .warehouse-selection-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        .warehouse-selection-container .card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .warehouse-selection-container .card-body {
            padding: 2rem;
        }
        .warehouse-selection-container h2 {
            color: #fff;
            margin-bottom: 1.5rem;
            text-align: center;
        }
        .warehouse-selection-container .form-group {
            margin-bottom: 1.5rem;
        }
        .warehouse-selection-container select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 0.8rem;
            font-size: 1.1rem;
        }
        .warehouse-selection-container select option {
            background: #2c3e50;
            color: #fff;
        }
        .warehouse-selection-container .btn-primary {
            width: 100%;
            padding: 1rem;
            font-size: 1.1rem;
            background: #3498db;
            border: none;
            border-radius: 8px;
            transition: background 0.3s;
        }
        .warehouse-selection-container .btn-primary:hover {
            background: #2980b9;
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            padding: 1rem;
        }

        .product-card {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 1rem;
            border: 1px solid var(--border-light);
            transition: transform var(--transition-speed) ease;
        }

        .product-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-color);
        }

        .product-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .product-info {
            text-align: center;
        }

        .product-info h3 {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .product-price {
            font-size: 1.3rem;
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .product-category {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }

        .modal-content {
            background: var(--bg-dark);
            border: 1px solid var(--border-light);
            border-radius: 15px;
            padding: 2rem;
            max-width: 600px;
            margin: 2rem auto;
            position: relative;
        }
        
        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            color: var(--text-light);
            cursor: pointer;
            font-size: 1.5rem;
        }

        .modal-title {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: #fff;
        }

        .dashboard-buttons {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 2rem;
        }
        .dashboard-link-btn {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: linear-gradient(90deg, #4e4ffa 0%, #6a82fb 100%);
            color: #fff !important;
            border: none;
            border-radius: 10px;
            padding: 0.9rem 2.2rem;
            font-size: 1.15rem;
            font-weight: 600;
            box-shadow: 0 4px 16px rgba(78, 79, 250, 0.15);
            transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .dashboard-link-btn i {
            font-size: 1.3rem;
        }
        .dashboard-link-btn:hover, .dashboard-link-btn:focus {
            background: linear-gradient(90deg, #6a82fb 0%, #4e4ffa 100%);
            transform: translateY(-2px) scale(1.04);
            box-shadow: 0 8px 24px rgba(78, 79, 250, 0.22);
            color: #fff !important;
        }

        .manager-dashboard-container {
            background: transparent;
            border-radius: 0;
            box-shadow: none;
            padding: 2.5rem 2rem;
            margin: 2rem auto 2rem auto;
            max-width: 1200px;
        }
        .manager-header {
            margin-bottom: 2.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid rgba(78, 79, 250, 0.15);
        }
        .manager-title {
            font-size: 2.3rem;
            font-weight: 700;
            color: #4e4ffa;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
        }
        .manager-branch-info {
            font-size: 1.1rem;
            color: #bfc9e0;
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .branch-name, .branch-address, .branch-supplier {
            display: block;
            margin-top: 0.2rem;
            color: #4e4ffa;
            font-weight: 500;
        }
        .manager-stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2.5rem;
        }
        .manager-stat-card {
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 12px rgba(78, 79, 250, 0.08);
            padding: 1.5rem 1.2rem;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 1.2rem;
        }
        .manager-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            box-shadow: 0 2px 12px rgba(78, 79, 250, 0.08);
            padding: 2rem 1.5rem 1.5rem 1.5rem;
            margin-bottom: 2.5rem;
        }
        .manager-section h2 {
            color: #4e4ffa;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 1.2rem;
            display: flex;
            align-items: center;
            gap: 0.6rem;
        }
        .dashboard-table th {
            color: #4e4ffa;
            font-weight: 600;
            background: rgba(255,255,255,0.07);
            border-bottom: 1.5px solid rgba(78, 79, 250, 0.15);
        }
        .dashboard-table td {
            color: #fff;
            background: transparent;
        }
        .btn-primary, .btn-outline-primary, .btn-outline-secondary, .btn-outline-success {
            border-radius: 8px;
            font-weight: 500;
            transition: background 0.2s, color 0.2s, box-shadow 0.2s;
        }
        .btn-primary {
            background: #4e4ffa;
            color: #fff;
            border: none;
        }
        .btn-primary:hover {
            background: #0102fa;
            color: #fff;
            box-shadow: 0 4px 16px rgba(78, 79, 250, 0.18);
        }
        .btn-outline-primary {
            color: #4e4ffa;
            border: 1.5px solid #4e4ffa;
            background: transparent;
        }
        .btn-outline-primary:hover {
            background: #4e4ffa;
            color: #fff;
        }
        .btn-outline-success {
            color: #10b981;
            border: 1.5px solid #10b981;
            background: transparent;
        }
        .btn-outline-success:hover {
            background: #10b981;
            color: #fff;
        }
        .btn-outline-secondary {
            color: #bfc9e0;
            border: 1.5px solid #bfc9e0;
            background: transparent;
        }
        .btn-outline-secondary:hover {
            background: #bfc9e0;
            color: #232b3e;
        }
        .dashboard-table tbody:empty::after {
            content: 'No data available';
            display: block;
            text-align: center;
            color: #a1a1aa;
            padding: 1.5rem;
            font-size: 1.1rem;
        }
        @media (max-width: 900px) {
            .manager-dashboard-container {
                padding: 1.2rem 0.5rem;
            }
            .manager-stats-container {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }

        /* Add dashboard navigation buttons */
        .manager-dashboard-nav {
            display: flex;
            gap: 1.5rem;
            justify-content: flex-start;
            margin-bottom: 2.5rem;
        }
        .manager-dashboard-nav .dashboard-link-btn {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: #4e4ffa;
            color: #fff !important;
            border: none;
            border-radius: 8px;
            padding: 0.8rem 2rem;
            font-size: 1.1rem;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(78, 79, 250, 0.10);
            transition: background 0.2s, transform 0.2s;
            text-decoration: none;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .manager-dashboard-nav .dashboard-link-btn:hover {
            background: #0102fa;
            color: #fff !important;
            transform: translateY(-2px) scale(1.04);
        }

        .badge {
            padding: 0.5em 0.8em;
            font-size: 0.85em;
        }
        .badge-warning {
            background-color: #ffc107;
            color: #000;
        }
        .badge-info {
            background-color: #17a2b8;
            color: #fff;
        }
        .badge-success {
            background-color: #28a745;
            color: #fff;
        }
        .badge-danger {
            background-color: #dc3545;
            color: #fff;
        }
        .badge-secondary {
            background-color: #6c757d;
            color: #fff;
        }
        .btn-sm {
            margin: 0 2px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.1rem;
            font-weight: 500;
            color: #666;
        }

        .btn-primary {
            background-color: #4CAF50;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: background-color 0.2s;
        }

        .btn-primary:hover {
            background-color: #45a049;
        }

        .btn-primary i {
            font-size: 0.9rem;
        }

        .action-buttons {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
        }

        .btn-action {
            padding: 0.4rem 0.8rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
            font-weight: 500;
            text-decoration: none;
            min-width: 70px;
            text-align: center;
        }

        .btn-edit {
            background-color: #2196F3;
            color: white;
        }

        .btn-delete {
            background-color: #f44336;
            color: white;
        }

        .btn-action:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .btn-action:active {
            transform: translateY(0);
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal-content {
            position: relative;
            background-color: #fff;
            margin: 15% auto;
            padding: 20px;
            border-radius: 8px;
            width: 400px;
            max-width: 90%;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .modal-header {
            margin-bottom: 1rem;
        }

        .modal-title {
            font-size: 1.2rem;
            font-weight: 500;
            color: #333;
        }

        .modal-body {
            margin-bottom: 1.5rem;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        .close-modal {
            position: absolute;
            right: 1rem;
            top: 1rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }

        .close-modal:hover {
            color: #333;
        }

        .dashboard-card {
            background: #000000;
            border-radius: 8px;
            box-shadow: none;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            color: #ffffff;
        }
    </style>
</head>
<body>
    <!-- Main Navbar (copied from index.html for consistency) -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="nav-container">
            <ul class="nav-links">
                <li class="nav-item"><a class="nav-link" href="/">HOME</a></li>
                <li class="nav-item"><a class="nav-link" href="/">ABOUT US</a></li>
                <li class="nav-item"><a class="nav-link" href="/">FEATURED PRODUCTS</a></li>
                <li class="nav-item"><a class="nav-link" href="/">NEW PRODUCTS</a></li>
                <li class="nav-item"><a class="nav-link" href="/">BRANDS</a></li>
                <li class="nav-item"><a class="nav-link" href="/">CONTACT</a></li>
               <li class="nav-item"><a class="nav-link" href="{{ get_dashboard_url() }}">DASHBOARD</a></li>

                        {% if data.dashboard_type == 'customer' %}
            <li class="nav-item" style="position:relative;">
                <a class="nav-link" href="{{ url_for('cart') }}" title="My Cart" style="display:flex;align-items:center;gap:8px;">
                    <i class="fa fa-shopping-cart" style="font-size:1.5em;"></i>
                    <span style="font-weight:600;">Cart</span>
                    {% if data.cart_count and data.cart_count > 0 %}
                    <span class="badge badge-pill badge-primary"
                        style="position:absolute;top:12px;right:10px;background:#4e4ffa;font-size:0.9em;">
                        {{ data.cart_count }}
                    </span>
                    {% endif %}
                </a>
            </li>
            {% endif %}
                <li class="nav-item"><a class="nav-link logout-btn" href="/logout">LOGOUT</a></li>
            </ul>
        </div>
    </nav>
   <div class="dashboard-container">
{% if data.dashboard_type == 'branch' %}
    <!-- ░░░ BRANCH DASHBOARD ░░░ -->
    <div class="welcome-hero">
        <h1 class="hero-title">Branch Overview</h1>
        <p class="hero-subtitle">{{ data.branch.name }}<br>{{ data.branch.address }}</p>
        <p>Manager: {{ data.manager.name }}</p>
        <p>Operating Hours: {{ data.branch.operating_hours or 'Not set' }}</p>
    </div>

    <div class="stats-container">
        <div class="stat-card">
            <div class="stat-title">Today's Orders</div>
            <div class="stat-value">{{ data.today_orders or 0 }}</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-title">Profit</div>
            <div class="stat-value">${{ "%.2f"|format(data.profit or 0) }}</div>
        </div>
    </div>
            <div class="table-responsive">
                <h2>Stock & Inventory</h2>
                <table class="dashboard-table">
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Stock</th>
                            <th>Min Stock</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in data.inventory %}
                        <tr>
                            <td>{{ item.name }}</td>
                            <td>{{ item.current_stock }}</td>
                            <td>{{ item.minimum_stock }}</td>
                            <td>
                                <span class="status-badge {% if item.status == 'low' %}status-warning{% else %}status-completed{% endif %}">
                                    {{ item.status|title }}
                                </span>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <div><strong>Incoming Shipments:</strong> {% if data.incoming_shipments %}{{ data.incoming_shipments|length }} incoming{% else %}None{% endif %}</div>
            </div>
             <div class="table-responsive">
        <h2>Recent Orders</h2>
        <table class="dashboard-table">
            <thead>
            <tr>
                <th>Order ID</th><th>Date</th><th>Total</th>
                <th>Customer ID</th><th>Status</th>
            </tr>
            </thead>
            <tbody>
            {% for order in data.recent_orders %}
            <tr>
                <td>#{{ order.order_id }}</td>
                <td>{{ order.date }}</td>
                <td>${{ "%.2f"|format(order.total_amount) }}</td>
                <td>#{{ order.customer_id }}</td>
                <td>
                    <span class="status-badge
                        {% if order.status == 'completed' %}status-completed
                        {% else %}status-warning{% endif %}">
                        {{ order.status|title }}
                    </span>
                </td>
            </tr>
            {% else %}
            <tr><td colspan="5" class="text-center text-muted">No recent orders found</td></tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
        {% elif data.dashboard_type == 'manager' %}
            <!-- Manager Dashboard -->
            <div class="manager-dashboard-container">
                <div class="manager-dashboard-nav">
                    <a href="{{ url_for('warehouse_dashboard') }}" class="dashboard-link-btn">
                        <i class="fa fa-warehouse"></i> Warehouse Dashboard
                    </a>
                </div>
                <div class="manager-header">
                    <div class="manager-title"><i class="fa fa-user-tie"></i> Manager Dashboard</div>
                    <div class="manager-branch-info">
                        <strong>My Branch Overview</strong><br>
                        {% if data.branch %}
                        <span class="branch-name"><i class="fa fa-building"></i> {{ data.branch.name }}</span><br>
                        <span class="branch-address"><i class="fa fa-map-marker-alt"></i> {{ data.branch.address }}</span><br>
                        {% endif %}
                        {% if data.primary_supplier %}
                        <span class="branch-supplier"><i class="fa fa-truck"></i> Primary Supplier: {{ data.primary_supplier }}</span>
                        {% endif %}
                    </div>
                </div>
                <div class="manager-stats-container">
                    {% if data.sales %}
                    <div class="manager-stat-card">
                        <div class="stat-title">Today's Revenue</div>
                        <div class="stat-value">${{ "%.2f"|format(data.sales.today_revenue) }}</div>
                    </div>
                    <div class="manager-stat-card">
                        <div class="stat-title">This Week's Revenue</div>
                        <div class="stat-value">${{ "%.2f"|format(data.sales.week_revenue) }}</div>
                    </div>
                    <div class="manager-stat-card">
                        <div class="stat-title">This Month's Revenue</div>
                        <div class="stat-value">${{ "%.2f"|format(data.sales.month_revenue) }}</div>
                    </div>
                    <div class="manager-stat-card">
                        <div class="stat-title">Today's Profit</div>
                        <div class="stat-value">${{ "%.2f"|format(data.sales.today_profit) }}</div>
                    </div>
                    <div class="manager-stat-card">
                        <div class="stat-title">This Week's Profit</div>
                        <div class="stat-value">${{ "%.2f"|format(data.sales.week_profit) }}</div>
                    </div>
                    <div class="manager-stat-card">
                        <div class="stat-title">This Month's Profit</div>
                        <div class="stat-value">${{ "%.2f"|format(data.sales.month_profit) }}</div>
                    </div>
                    {% endif %}
                </div>
                <div class="manager-section">
                    <h2><i class="fas fa-truck-loading"></i> Warehouse Supply Information</h2>
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5 class="mb-0">Branches Supplied by This Warehouse</h5>
                        </div>
                        <div class="card-body">
                            {% if data.branches_supplied %}
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Branch Name</th>
                                                <th>Address</th>
                                                <th>Supply Status</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for supply in data.branches_supplied %}
                                            <tr>
                                                <td>{{ supply.branch_name }}</td>
                                                <td>{{ supply.address }}</td>
                                                <td>
                                                    {% if supply.is_primary_supplier %}
                                                        <span class="badge bg-success">Primary Supplier</span>
                                                    {% else %}
                                                        <span class="badge bg-info">Secondary Supplier</span>
                                                    {% endif %}
                                                </td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            {% else %}
                                <div class="text-center py-4">
                                    <p class="text-muted mb-0">No branches are currently supplied by this warehouse</p>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="manager-section">
                    <div class="card mb-4">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">Purchase Orders</h5>
                            <a href="{{ url_for('create_purchase_order') }}" class="btn btn-primary">
                                Create Purchase Order
                            </a>
                        </div>
                        <div class="card-body">
                            {% if data.purchase_orders %}
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>PO ID</th>
                                                <th>Date</th>
                                                <th>Supplier</th>
                                                <th>Warehouse</th>
                                                <th>Delivery Date</th>
                                                <th>Status</th>
                                                <th>Items</th>
                                                <th>Total</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for po in data.purchase_orders %}
                                            <tr>
                                                <td>#{{ po.purchase_order_id }}</td>
                                                <td>
                                                    {% if po.order_date %}
                                                        {{ po.order_date.strftime('%Y-%m-%d') }}
                                                    {% else %}
                                                        N/A
                                                    {% endif %}
                                                </td>
                                                <td>{{ po.supplier_name }}</td>
                                                <td>{{ po.warehouse_name }}</td>
                                                <td>
                                                    {% if po.expected_delivery_date %}
                                                        {{ po.expected_delivery_date.strftime('%Y-%m-%d') }}
                                                    {% else %}
                                                        N/A
                                                    {% endif %}
                                                </td>
                                                <td>
                                                    <span class="badge bg-{{
                                                        'success' if po.status == 'completed' 
                                                        else 'warning' if po.status == 'pending'
                                                        else 'info' if po.status == 'approved'
                                                        else 'primary' if not po.status or po.status == ''
                                                        else 'secondary' }}">
                                                        {{ po.status|title if po.status else 'Ordered' }}
                                                    </span>
                                                </td>
                                                <td>
                                                    <span title="{{ po.product_list }}">
                                                        {{ po.total_items }} items
                                                    </span>
                                                </td>
                                                <td>${{ "%.2f"|format(po.total_amount) }}</td>
                                                <td class="action-buttons">
                                                    <a href="{{ url_for('edit_purchase_order', order_id=po.purchase_order_id) }}" class="btn btn-edit">
                                                        Edit
                                                    </a>
                                                    <form method="POST" action="{{ url_for('delete_purchase_order', order_id=po.purchase_order_id) }}" style="display: inline;">
                                                        <button type="submit" class="btn btn-delete" onclick="return confirm('Are you sure you want to delete this purchase order?')">
                                                            Delete
                                                        </button>
                                                    </form>
                                                </td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            {% else %}
                                <div class="text-center py-4">
                                    <p class="text-muted mb-0">No purchase orders found</p>
                                    <a href="{{ url_for('create_purchase_order') }}" class="btn btn-primary mt-3">
                                        <i class="fas fa-plus"></i> Create Your First Purchase Order
                                    </a>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="dashboard-section">
  <h2>🧾 Orders</h2>

  <!-- toggle -->
 <div style="margin-bottom:1rem; display:flex; gap:0.5rem; align-items:center;">
      <input id="mgrOrdersSearchBox" type="text" class="form-control" placeholder="Search orders (ID, branch, customer)" style="max-width:280px;">
      <button id="mgrOrdersSearchBtn" class="btn btn-primary">
          <i class="fa fa-search"></i> Search
      </button>
      <button id="mgrToggleOrders" class="btn btn-secondary">
          Show Orders
      </button>
  </div>

  <!-- scrollable container -->
  <div id="mgrOrdersContainer"
       style="display:none; max-height:400px; overflow:auto;"></div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const btn       = document.getElementById('mgrToggleOrders');
    const container = document.getElementById('mgrOrdersContainer');
    const searchBox = document.getElementById('mgrOrdersSearchBox');
    const searchBtn = document.getElementById('mgrOrdersSearchBtn');
    let lastSearch  = '';
    let visible     = false;

    async function loadOrders(search = '') {
        let url = '{{ url_for("orders_data") }}';
        if (search) url += '?search=' + encodeURIComponent(search);
        const res  = await fetch(url);
        if (!res.ok) {
            container.innerHTML = `<div class="text-danger">Failed to load orders</div>`;
            return;
        }
        const data = await res.json();
        let html = `<table class="dashboard-table">
          <thead>
            <tr>
              <th>ID</th><th>Date</th><th>Branch</th><th>Customer</th>
              <th>Total ($)</th><th>Profit ($)</th><th>Status</th>
            </tr>
          </thead>
          <tbody>`;
        if (data.length === 0) {
            html += `<tr><td colspan="7" style="text-align:center;">No orders found</td></tr>`;
        } else {
            data.forEach(o => {
                html += `<tr>
                    <td>${o.order_id}</td>
                    <td>${o.sale_date}</td>
                    <td>${o.branch}</td>
                    <td>${o.customer}</td>
                    <td>${o.total.toFixed(2)}</td>
                    <td>${o.profit.toFixed(2)}</td>
                    <td>${o.status}</td>
                </tr>`;
            });
        }
        html += '</tbody></table>';
        container.innerHTML = html;
    }

    btn.addEventListener('click', () => {
        visible = !visible;
        if (visible) {
            container.style.display = 'block';
            btn.textContent = 'Hide Orders';
            loadOrders(lastSearch);
        } else {
            container.style.display = 'none';
            btn.textContent = 'Show Orders';
        }
    });

    searchBtn.addEventListener('click', () => {
        lastSearch = searchBox.value.trim();
        if (!visible) {
            visible = true;
            container.style.display = 'block';
            btn.textContent = 'Hide Orders';
        }
        loadOrders(lastSearch);
    });

    searchBox.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            lastSearch = searchBox.value.trim();
            if (!visible) {
                visible = true;
                container.style.display = 'block';
                btn.textContent = 'Hide Orders';
            }
            loadOrders(lastSearch);
        }
    });
});
</script>

<div class="mb-3">
  <a href="{{ url_for('add_customer') }}" class="btn btn-success me-2">
      + Add Customer
  </a>
  <a href="{{ url_for('add_product') }}" class="btn btn-success">
      + Add Product
  </a>
</div>


            </div>
            
        {% elif data.dashboard_type == 'warehouse' %}
           
            <!-- Inventory Management -->
            <div class="dashboard-card">
                <h2>Inventory Management</h2>
                <table class="dashboard-table">
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Stock</th>
                            <th>Min Stock</th>
                            <th>Max Stock</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in data.inventory %}
                        <tr>
                            <td>{{ item.name }}</td>
                            <td>{{ item.current_stock }}</td>
                            <td>{{ item.minimum_stock }}</td>
                            <td>{{ item.maximum_stock }}</td>
                            <td>
                                {% if item.status == 'low' %}
                                    <span class="status-badge status-warning">Low</span>
                                {% elif item.status == 'well stocked' %}
                                    <span class="status-badge status-success">Well Stocked</span>
                                {% else %}
                                    <span class="status-badge status-info">Normal</span>
                                {% endif %}
                            </td>
                        </tr>
                        {% else %}
                        <tr><td colspan="5" class="text-center text-muted">No inventory data available</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <!-- Purchase Orders -->
            <div class="dashboard-card">
                <h2>Purchase Orders</h2>
                <table class="dashboard-table">
                    <thead>
                        <tr>
                            <th>Supplier</th>
                            <th>Order Date</th>
                            <th>Delivery Date</th>
                            <th>Status</th>
                            <th>Total Items</th>
                            <th>Total Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for order in data.purchase_orders %}
                        <tr>
                            <td>{{ order.supplier_name }}</td>
                            <td>
                                {% if order.order_date %}
                                    {{ order.order_date.strftime('%Y-%m-%d') }}
                                {% else %}
                                    N/A
                                {% endif %}
                            </td>
                            <td>
                                {% if order.expected_delivery_date %}
                                    {{ order.expected_delivery_date.strftime('%Y-%m-%d') }}
                                {% else %}
                                    N/A
                                {% endif %}
                            </td>
                            <td>
                                <span class="status-badge status-{{ order.status_color }}">
                                    {{ order.status }}
                                </span>
                            </td>
                            <td>{{ order.total_items }}</td>
                            <td>${{ "%.2f"|format(order.total_amount) }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <!-- Supplier Management -->
            <div class="dashboard-card">
                <h2>Supplier Management</h2>
                <table class="dashboard-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Phone</th>
                            <th>Address</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if data.suppliers and data.suppliers|length > 0 %}
                            {% for supplier in data.suppliers %}
                            <tr>
                                <td>{{ supplier.name }}</td>
                                <td>{{ supplier.phone }}</td>
                                <td>{{ supplier.address }}</td>
                            </tr>
                            {% endfor %}
                        {% else %}
                            <tr><td colspan="3" class="text-center text-muted">No suppliers found</td></tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>

           
 {% elif data.dashboard_type == 'employee' %}
<!-- ───────────────────────────────────────────────────────────── -->
<!-- Employee Dashboard -->
<!-- ───────────────────────────────────────────────────────────── -->
<div class="welcome-hero">
  <h1 class="hero-title">Employee Dashboard</h1>

  <div class="employee-info">
    <p><strong>Email:</strong> {{ data.employee.email }}</p>
    <p><strong>Phone:</strong> {{ data.employee.phone }}</p>
    <p><strong>Position:</strong> {{ data.employee.position }}</p>
    <p><strong>Branch:</strong> {{ data.employee.branch }}</p>

    
  </div>
</div>

<!-- ── Stats ──────────────────────────────────────────────────── -->
<div class="dashboard-section">
  <h2>📈 Today’s Summary</h2>
  <ul>
    <li><strong>Orders Today:</strong> {{ data.today_orders }}</li>
    <li><strong>Revenue Today:</strong>
        ${{ "%.2f"|format(data.today_revenue) }}</li>
  </ul>
</div>

<!-- ── Low Stock Products ─────────────────────────────────────── -->
<div class="dashboard-section">
  <h2>🚨 Low Stock Products</h2>
  {% if data.low_stock %}
    <ul>
      {% for item in data.low_stock %}
        <li>
          {{ item.name }} — {{ item.quantity_in_stock }} left
          (min {{ item.minimum_stock }})
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p class="text-muted">All stock levels are healthy 🎉</p>
  {% endif %}
</div>

<!-- ── Recent Branch Orders ───────────────────────────────────── -->
<div class="dashboard-section">
  <h2>🛒 Recent Branch Orders</h2>
  <div class="table-responsive">
    <table class="dashboard-table">
      <thead>
        <tr>
          <th>Order ID</th><th>Date</th><th>Total</th>
          <th>Customer</th>
        </tr>
      </thead>
      <tbody>
        {% for order in data.recent_orders %}
        <tr>
          <td>#{{ order.order_id }}</td>
          <td>{{ order.sale_date }}</td>
          <td>${{ "%.2f"|format(order.total_amount) }}</td>
          <td>{{ order.customer_name }}</td>
          
        </tr>
        {% else %}
        <tr>
          <td colspan="5" class="text-center text-muted">No recent orders</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- ── Orders Processed by Employee ───────────────────────────── -->
<div class="dashboard-section">
  <h2>🧾 Orders You Processed</h2>
  {% if data.my_orders %}
  <div class="table-responsive">
    <table class="dashboard-table">
      <thead>
        <tr>
          <th>Order ID</th><th>Date</th><th>Total</th>
          <th>Customer</th>
        </tr>
      </thead>
      <tbody>
        {% for order in data.my_orders %}
        <tr>
          <td>#{{ order.order_id }}</td>
          <td>{{ order.sale_date }}</td>
          <td>${{ "%.2f"|format(order.total_amount) }}</td>
          <td>{{ order.customer_name }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
    <p class="text-muted">No orders processed by you yet.</p>
  {% endif %}
</div>

<!-- ── Today’s Sales by Category ──────────────────────────────── -->
<div class="dashboard-section">
  <h2>📊  Sales by Category</h2>
  {% if data.today_sales %}
  <div class="table-responsive">
    <table class="dashboard-table">
      <thead>
        <tr>
          <th>Category</th><th>Items</th>
          <th>Revenue ($)</th><th>Profit ($)</th>
        </tr>
      </thead>
      <tbody>
        {% for row in data.today_sales %}
        <tr>
          <td>{{ row.category }}</td>
          <td>{{ row.items_sold }}</td>
          <td>${{ "%.2f"|format(row.revenue) }}</td>
          <td>${{ "%.2f"|format(row.profit) }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
    <p class="text-muted">No sales recorded today.</p>
  {% endif %}
</div>

<!-- ── Async Branch-wide Orders toggle ─────────────────────────── -->
<div class="dashboard-section">
  <h2>🔍 All Branchs Orders</h2>
   <div style="margin-bottom:1rem; display:flex; gap:0.5rem; align-items:center;">
      <input id="empOrdersSearchBox" type="text" class="form-control" placeholder="Search orders (ID, branch, customer)" style="max-width:280px;">
      <button id="empOrdersSearchBtn" class="btn btn-primary">
          <i class="fa fa-search"></i> Search
      </button>
      <button id="empToggleOrders" class="btn btn-secondary">
          Show Orders
      </button>
  </div>
  <div id="empOrdersContainer"
       style="display:none; max-height:400px; overflow:auto;"></div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const btn       = document.getElementById('empToggleOrders');
    const container = document.getElementById('empOrdersContainer');
    const searchBox = document.getElementById('empOrdersSearchBox');
    const searchBtn = document.getElementById('empOrdersSearchBtn');
    let lastSearch  = '';
    let visible     = false;

    async function loadOrders(search = '') {
        let url = '{{ url_for("orders_data") }}';
        if (search) url += '?search=' + encodeURIComponent(search);
        const res  = await fetch(url);
        if (!res.ok) {
            container.innerHTML = `<div class="text-danger">Failed to load orders</div>`;
            return;
        }
        const data = await res.json();
        let html = `<table class="dashboard-table">
          <thead>
            <tr>
              <th>ID</th><th>Date</th><th>Branch</th><th>Customer</th>
              <th>Total ($)</th><th>Profit ($)</th><th>Status</th>
            </tr>
          </thead>
          <tbody>`;
        if (data.length === 0) {
            html += `<tr><td colspan="7" style="text-align:center;">No orders found</td></tr>`;
        } else {
            data.forEach(o => {
                html += `<tr>
                    <td>${o.order_id}</td>
                    <td>${o.sale_date}</td>
                    <td>${o.branch}</td>
                    <td>${o.customer}</td>
                    <td>${o.total.toFixed(2)}</td>
                    <td>${o.profit.toFixed(2)}</td>
                    <td>${o.status}</td>
                </tr>`;
            });
        }
        html += '</tbody></table>';
        container.innerHTML = html;
    }

    btn.addEventListener('click', () => {
        visible = !visible;
        if (visible) {
            container.style.display = 'block';
            btn.textContent = 'Hide Orders';
            loadOrders(lastSearch);
        } else {
            container.style.display = 'none';
            btn.textContent = 'Show Orders';
        }
    });

    searchBtn.addEventListener('click', () => {
        lastSearch = searchBox.value.trim();
        if (!visible) {
            visible = true;
            container.style.display = 'block';
            btn.textContent = 'Hide Orders';
        }
        loadOrders(lastSearch);
    });

    searchBox.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            lastSearch = searchBox.value.trim();
            if (!visible) {
                visible = true;
                container.style.display = 'block';
                btn.textContent = 'Hide Orders';
            }
            loadOrders(lastSearch);
        }
    });
});
</script>


<!-- ── Quick Actions ───────────────────────────────────────────── -->
<div class="mb-3 mt-3">
  <a href="{{ url_for('add_customer') }}" class="btn btn-success me-2">
    + Add Customer
  </a>
  <a href="{{ url_for('add_product') }}" class="btn btn-success">
    + Add Product
  </a>
</div>

 {% elif data.dashboard_type == 'customer' %}
            <!-- Customer Dashboard -->
            <div class="welcome-hero">
                <h1 class="hero-title">Welcome, {{ data.customer.name }}!</h1>
            </div>
            <div class="customer-info-card" style="background:#181818; color:#fff; border-radius:12px; padding:2rem; margin-bottom:2rem; box-shadow:0 2px 8px rgba(0,0,0,0.08); max-width:500px;">
                <h2 style="margin-top:0;">My Info</h2>
                <p><strong>Email:</strong> {{ data.customer.email }}</p>
                <p><strong>Phone:</strong> {{ data.customer.phone or 'Not set' }}</p>
                <p><strong>Delivery Address:</strong> {{ data.customer.address or 'Not set' }}</p>
            </div>
            <div class="dashboard-buttons" style="margin-bottom:2rem;">
        <a href="{{ url_for('cart') }}" class="dashboard-link-btn">
            <i class="fa fa-shopping-cart"></i> View Cart
            {% if data.cart_count and data.cart_count > 0 %}
                <span class="badge badge-pill badge-primary" style="background:#4e4ffa; margin-left:6px;">{{ data.cart_count }}</span>
            {% endif %}
        </a>
        
    </div>
            <div class="customer-section" style="margin-bottom:2rem;">
                 <h2>🛒 Create a New Order</h2>
                <a href="{{ url_for('new_order') }}" class="btn btn-primary">Make New Order</a>
                <h2>📦 My Orders</h2>
                {% if data.recent_orders and data.recent_orders|length > 0 %}
                    <table class="dashboard-table">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Products</th>
                                <th>Total</th>
                                <th>Estimated Delivery</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for order in data.recent_orders %}
                            <tr>
                                <td>{{ order.id }}</td>
                                <td>{{ order.date }}</td>
                                <td>{{ order.status }}</td>
                                <td>
                                    <ul style="margin:0; padding-left:1em;">
                                        {% for item in order.products %}
                                        <li>{{ item.name }} (x{{ item.quantity }})</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                                <td>${{ order.total }}</td>
                                <td>{{ order.estimated_delivery or 'N/A' }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <div style="color:#aaa; padding:1rem 0;">No orders yet.</div>
                {% endif %}
            </div>
            
                
                
        {% elif data.dashboard_type == 'owner' %}
            <!-- Owner Dashboard -->
            <div class="welcome-hero">
                <h1 class="hero-title">Owner Dashboard</h1>
                <p class="hero-subtitle">Welcome, {{ session.get('name', 'Owner') }}!</p>
            </div>
            <!-- 1. Business Overview -->
            <div class="dashboard-section">
                <h2>📊 Business Overview</h2>
                {% if data.stats %}
                <ul>
                    <li><strong>Total Revenue:</strong> ${{ data.stats.total_revenue }}</li>
                    <li><strong>Total Profit:</strong> ${{ data.stats.total_profit }}</li>
                    <li><strong>Active Branches:</strong> {{ data.stats.total_branches }}</li>
                    <li><strong>Total Orders:</strong> {{ data.stats.total_orders }}</li>
                    <li><strong>Total Employees:</strong> {{ data.stats.total_employees }}</li>
                    <li><strong>Total Products:</strong> {{ data.stats.total_products }}</li>
                </ul>
                {% else %}
                <div style="color:#aaa;">No business stats available.</div>
                {% endif %}
            </div>
            <!-- 2. Branches Overview -->
            <div class="dashboard-section">
                <h2>🏢 Branches Overview</h2>
                <a href="{{ url_for('create_branch') }}" class="btn btn-primary" style="margin-bottom: 1rem;">Create New Branch</a>
                {% if data.branches and data.branches|length > 0 %}
                <table class="dashboard-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Address</th>
                            <th>Manager</th>
                            <th>Sales</th>
                            <th>Profit</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for branch in data.branches %}
                        <tr>
                            <td>{{ branch.name }}</td>
                            <td>{{ branch.address or 'N/A' }}</td>
                            <td>{{ branch.manager or 'N/A' }}</td>
                            <td>${{ branch.revenue or 0 }}</td>
                            <td>${{ branch.profit or 0 }}</td>
                            <td>
                                <a href="{{ url_for('edit_branch', branch_id=branch.id) }}" class="btn btn-edit">Edit</a>
                                <form method="POST" action="{{ url_for('delete_branch', branch_id=branch.id) }}" style="display:inline;">
                                    <button type="submit" class="btn btn-delete" onclick="return confirm('Are you sure you want to delete this branch?')">Delete</button>
                                </form>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <div style="color:#aaa;">No branch data available.</div>
                {% endif %}
            </div>
            <!-- 3. Warehouses Overview -->
            <div class="dashboard-section">
                <h2>🏬 Warehouses Overview</h2>
                <a href="{{ url_for('create_warehouse') }}" class="btn btn-primary" style="margin-bottom: 1rem;">Create New Warehouse</a>
                {% if data.warehouses and data.warehouses|length > 0 %}
                <table class="dashboard-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Location</th>
                            <th>Manager</th>
                            <th>Capacity</th>
                            <th>Storage Used</th>
                            <th>Products</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for warehouse in data.warehouses %}
                        <tr>
                            <td>{{ warehouse.name }}</td>
                            <td>{{ warehouse.address }}</td>
                            <td>{{ warehouse.manager }}</td>
                            <td>{{ warehouse.capacity }} units</td>
                            <td>
                                {{ warehouse.storage_used }} units
                                <div class="progress" style="height: 5px; margin-top: 5px;">
                                    <div class="progress-bar {% if warehouse.storage_percentage > 90 %}bg-danger{% elif warehouse.storage_percentage > 70 %}bg-warning{% else %}bg-success{% endif %}" 
                                         role="progressbar" 
                                         style="width: {{ warehouse.storage_percentage }}%"
                                         aria-valuenow="{{ warehouse.storage_percentage }}" 
                                         aria-valuemin="0" 
                                         aria-valuemax="100">
                                    </div>
                                </div>
                                <small class="text-muted">{{ warehouse.storage_percentage }}%</small>
                            </td>
                            <td>{{ warehouse.total_products }}</td>
                            <td>
                                <a href="{{ url_for('edit_warehouse', warehouse_id=warehouse.id) }}" class="btn btn-edit">Edit</a>
                                <form method="POST" action="{{ url_for('delete_warehouse', warehouse_id=warehouse.id) }}" style="display:inline;">
                                    <button type="submit" class="btn btn-delete" onclick="return confirm('Are you sure you want to delete this warehouse?')">Delete</button>
                                </form>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <div style="color:#aaa;">No warehouse data available.</div>
                {% endif %}
            </div>
           
            <!-- 5. Sales & Profit Analytics -->
            <div class="dashboard-section">
                <h2>📈 Sales & Profit Analytics</h2>
                <button id="toggleSales" class="btn btn-secondary">
                    Show Sales & Profit
                </button>

                    <!-- Hidden by default; we'll populate it the first time the button is pressed -->
                    <div id="salesProfitContainer" style="display:none; margin-top:1rem;"></div>
                
            </div>
            <!-- 6. Employee Management -->
            <div class="dashboard-section">
                <h2>👥 Employee Management</h2>
                <div class="section-header">
                    <div class="section-title">Employee List</div>
                    <a href="{{ url_for('add_employee') }}" class="btn btn-primary">Add New Employee</a>
                </div>
                {% if data.employees %}
                <div class="table-responsive">
                    <table class="dashboard-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Position</th>
                                <th>Contact</th>
                                <th>Location</th>
                                <th>Salary</th>
                                <th>Hire Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for employee in data.employees %}
                            <tr>
                                <td>
                                    <div class="employee-name">{{ employee.name }}</div>
                                    <small class="text-muted">{{ employee.email }}</small>
                                </td>
                                <td>{{ employee.position or 'Employee' }}</td>
                                <td>{{ employee.phone or 'N/A' }}</td>
                                <td>
                                    {% if employee.warehouse != 'Not Assigned' %}
                                        <span class="badge badge-info">Warehouse: {{ employee.warehouse }}</span>
                                    {% endif %}
                                    {% if employee.branch != 'Not Assigned' %}
                                        <span class="badge badge-primary">Branch: {{ employee.branch }}</span>
                                    {% endif %}
                                    {% if employee.warehouse == 'Not Assigned' and employee.branch == 'Not Assigned' %}
                                        <span class="text-muted">Not Assigned</span>
                                    {% endif %}
                                </td>
                                <td>${{ "%.2f"|format(employee.salary) }}</td>
                                <td>{{ employee.hire_date.strftime('%Y-%m-%d') if employee.hire_date else 'N/A' }}</td>
                                <td>
                                    <div class="action-buttons">
                                        <a href="{{ url_for('edit_employee', employee_id=employee.id) }}" 
                                           class="btn-action btn-edit" 
                                           title="Edit Employee">
                                            Edit
                                        </a>
                                        <button onclick="confirmDeleteEmployee({{ employee.id }}, '{{ employee.name }}')" 
                                                class="btn-action btn-delete" 
                                                title="Delete Employee">
                                            Delete
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div style="color:#aaa;">No employee data available.</div>
                {% endif %}
            </div>
            <!-- 7. Supplier & Purchase Oversight -->
            <div class="dashboard-section">
                <div class="section-header">
                    <h2>👨‍🔧 Supplier & Purchase Oversight</h2>
                    <a href="{{ url_for('create_purchase_order') }}" class="btn btn-primary">Create Purchase Order</a>
                </div>
              
                <!-- Purchase Orders Table -->
                <div class="table-responsive">
                    <table class="dashboard-table">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Supplier</th>
                                <th>Warehouse</th>
                                <th>Order Date</th>
                                <th>Expected Delivery</th>
                                <th>Status</th>
                                <th>Total Items</th>
                                <th>Total Amount</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for order in data.purchase_orders %}
                            <tr>
                                <td>#{{ order.purchase_order_id }}</td>
                                <td>{{ order.supplier_name }}</td>
                                <td>{{ order.warehouse_name }}</td>
                                <td>{{ order.order_date.strftime('%Y-%m-%d') if order.order_date else 'N/A' }}</td>
                                <td>{{ order.expected_delivery_date.strftime('%Y-%m-%d') if order.expected_delivery_date else 'N/A' }}</td>
                                <td>
                                    <span class="status-badge status-{{ order.status|lower }}">
                                        {{ order.status|title }}
                                    </span>
                                </td>
                                <td>{{ order.total_items }}</td>
                                <td>${{ "%.2f"|format(order.total_amount) }}</td>
                                <td class="action-buttons">
                                    <a href="{{ url_for('edit_purchase_order', order_id=order.purchase_order_id) }}" class="btn btn-edit">
                                        Edit
                                    </a>
                                    <form method="POST" action="{{ url_for('delete_purchase_order', order_id=order.purchase_order_id) }}" style="display: inline;">
                                        <button type="submit" class="btn btn-delete" onclick="return confirm('Are you sure you want to delete this purchase order?')">
                                            Delete
                                        </button>
                                    </form>
                                </td>
                            </tr>
                            {% else %}
                            <tr>
                                <td colspan="9" class="text-center text-muted">No purchase orders found</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

                <!-- Suppliers Table -->
                <h3 style="margin-top: 2rem;">Suppliers</h3>
                <div class="table-responsive">
                    <table class="dashboard-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Address</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if data.suppliers and data.suppliers|length > 0 %}
                                {% for supplier in data.suppliers %}
                                <tr>
                                    <td>{{ supplier.name }}</td>
                                    <td>{{ supplier.email }}</td>
                                    <td>{{ supplier.phone }}</td>
                                    <td>{{ supplier.address }}</td>
                                    <td><!-- Actions here if needed --></td>
                                </tr>
                                {% endfor %}
                            {% else %}
                                <tr><td colspan="5" class="text-center text-muted">No suppliers found</td></tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>


            <style>
                .section-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 1.5rem;
                }

                .section-header h2 {
                    margin: 0;
                }

                .status-badge {
                    padding: 0.25rem 0.5rem;
                    border-radius: 4px;
                    font-size: 0.875rem;
                    font-weight: 500;
                }

                .status-pending {
                    background-color: #fff3cd;
                    color: #856404;
                }

                .status-processing {
                    background-color: #cce5ff;
                    color: #004085;
                }

                .status-completed {
                    background-color: #d4edda;
                    color: #155724;
                }

                .status-cancelled {
                    background-color: #f8d7da;
                    color: #721c24;
                }

                .btn-view {
                    background-color: #17a2b8;
                    color: white;
                }

                .action-buttons {
                    display: flex;
                    gap: 0.5rem;
                }
            </style>

            <!-- Delete Order Confirmation Modal -->
            <div id="deleteOrderModal" class="modal">
                <div class="modal-content">
                    <span class="close-modal" onclick="closeDeleteOrderModal()">&times;</span>
                    <div class="modal-header">
                        <h3 class="modal-title">Confirm Delete</h3>
                    </div>
                    <div class="modal-body">
                        Are you sure you want to delete this purchase order?
                        This action cannot be undone.
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" onclick="closeDeleteOrderModal()">Cancel</button>
                        <button class="btn btn-delete" onclick="deleteOrder()">Delete</button>
                    </div>
                </div>
            </div>

            <!-- Delete Supplier Confirmation Modal -->
            <div id="deleteSupplierModal" class="modal">
                <div class="modal-content">
                    <span class="close-modal" onclick="closeDeleteSupplierModal()">&times;</span>
                    <div class="modal-header">
                        <h3 class="modal-title">Confirm Delete</h3>
                    </div>
                    <div class="modal-body">
                        Are you sure you want to delete this supplier?
                        This action cannot be undone.
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" onclick="closeDeleteSupplierModal()">Cancel</button>
                        <button class="btn btn-delete" onclick="deleteSupplier()">Delete</button>
                    </div>
                </div>
            </div>

            <script>
                let orderToDelete = null;
                let supplierToDelete = null;

                function confirmDeleteOrder(orderId) {
                    orderToDelete = orderId;
                    document.getElementById('deleteOrderModal').style.display = 'block';
                }

                function closeDeleteOrderModal() {
                    document.getElementById('deleteOrderModal').style.display = 'none';
                    orderToDelete = null;
                }

                function deleteOrder() {
                    if (orderToDelete) {
                        window.location.href = `/delete_purchase_order/${orderToDelete}`;
                    }
                }

                function confirmDeleteSupplier(supplierId) {
                    supplierToDelete = supplierId;
                    document.getElementById('deleteSupplierModal').style.display = 'block';
                }

                function closeDeleteSupplierModal() {
                    document.getElementById('deleteSupplierModal').style.display = 'none';
                    supplierToDelete = null;
                }

                function deleteSupplier() {
                    if (supplierToDelete) {
                        window.location.href = `/delete_supplier/${supplierToDelete}`;
                    }
                }

                // Close modals when clicking outside
                window.onclick = function(event) {
                    const orderModal = document.getElementById('deleteOrderModal');
                    const supplierModal = document.getElementById('deleteSupplierModal');
                    if (event.target == orderModal) {
                        closeDeleteOrderModal();
                    }
                    if (event.target == supplierModal) {
                        closeDeleteSupplierModal();
                    }
                }
            </script>
              <!-- 5b. Orders List -->
<div class="dashboard-section">
    <h2>🧾 All Orders</h2>

<div style="margin-bottom:1rem; display:flex; gap:0.5rem; align-items:center;">
        <input id="ordersSearchBox" type="text" class="form-control" placeholder="Search orders (ID, branch, customer)" style="max-width:280px;">
        <button id="ordersSearchBtn" class="btn btn-primary">
            <i class="fa fa-search"></i> Search
        </button>
        <button id="toggleOrders" class="btn btn-secondary">
            Show Orders
        </button>
    </div>


    <!-- hidden until clicked -->
    <div id="ordersContainer" style="display:none; margin-top:1rem; max-height:400px; overflow:auto;"></div>
</div>


        {% endif %}
    </div>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <!-- Add necessary modals and JavaScript -->
    <script>
    function showModal(modalId) {
        // Implementation for showing modals
        console.log('Showing modal:', modalId);
    }

    function requestStock(productId) {
        // Implementation for requesting stock
        console.log('Requesting stock for product:', productId);
        // TODO: Implement stock request functionality
        alert('Stock request feature coming soon!');
    }

    function viewOrderDetails(orderId) {
        // Implementation for viewing order details
        console.log('Viewing order details:', orderId);
    }

    let employeeToDelete = null;

    function confirmDeleteEmployee(employeeId, employeeName) {
        employeeToDelete = employeeId;
        document.getElementById('employeeName').textContent = employeeName;
        document.getElementById('deleteModal').style.display = 'block';
    }

    function closeDeleteModal() {
        document.getElementById('deleteModal').style.display = 'none';
        employeeToDelete = null;
    }

    function deleteEmployee() {
        if (employeeToDelete) {
            // Create a form and submit it via POST
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = `/delete_employee/${employeeToDelete}`;
            document.body.appendChild(form);
            form.submit();
        }
    }

    // Close modal when clicking outside
    window.onclick = function(event) {
        const modal = document.getElementById('deleteModal');
        if (event.target == modal) {
            closeDeleteModal();
        }
    }
  
document.getElementById('toggleSales').addEventListener('click', async () => {
  const btn       = document.getElementById('toggleSales');
  const container = document.getElementById('salesProfitContainer');

  // If it's hidden, either fetch + render OR just un-hide
  if (container.style.display === 'none') {
    // First time? Pull data from the new endpoint
    if (!container.dataset.loaded) {
      const res  = await fetch('{{ url_for("sales_profit_data") }}');
      const data = await res.json();

      // Quick table render – tweak CSS to taste
      let html = `
        <table class="dashboard-table">
          <thead><tr><th>Branch</th><th>Revenue ($)</th><th>Profit ($)</th></tr></thead>
          <tbody>`;
      data.forEach(b => {
        html += `<tr>
                   <td>${b.name}</td>
                   <td>${b.revenue.toFixed(2)}</td>
                   <td>${b.profit.toFixed(2)}</td>
                 </tr>`;
      });
      html += '</tbody></table>';

      container.innerHTML = html;
      container.dataset.loaded = 'true';  // so we don't fetch again
    }

    container.style.display = 'block';
    btn.textContent = 'Hide Sales & Profit';
  } else {
    // Hide it again
    container.style.display = 'none';
    btn.textContent = 'Show Sales & Profit';
  }
});

/* … existing Sales & Profit JS … */

/* ---- Orders toggle ---- */

document.addEventListener('DOMContentLoaded', () => {
    const btn       = document.getElementById('toggleOrders');
    const container = document.getElementById('ordersContainer');
    const searchBox = document.getElementById('ordersSearchBox');
    const searchBtn = document.getElementById('ordersSearchBtn');

    let lastSearch  = '';
    let visible     = false;

    // Helper to load (optionally filtered) orders via AJAX
    async function loadOrders(search = '') {
        let url = '{{ url_for("orders_data") }}';
        if (search) url += '?search=' + encodeURIComponent(search);
        const res  = await fetch(url);
        if (!res.ok) {
            container.innerHTML = `<div class="text-danger">Failed to load orders</div>`;
            return;
        }
        const data = await res.json();
        let html = `
            <table class="dashboard-table">
            <thead>
                <tr>
                    <th>ID</th><th>Date</th><th>Branch</th><th>Customer</th>
                    <th>Total ($)</th><th>Profit ($)</th><th>Status</th>
                </tr>
            </thead>
            <tbody>
        `;
        if (data.length === 0) {
            html += `<tr><td colspan="7" style="text-align:center;">No orders found</td></tr>`;
        } else {
            data.forEach(o => {
                html += `<tr>
                    <td>${o.order_id}</td>
                    <td>${o.sale_date}</td>
                    <td>${o.branch}</td>
                    <td>${o.customer}</td>
                    <td>${o.total.toFixed(2)}</td>
                    <td>${o.profit.toFixed(2)}</td>
                    <td>${o.status}</td>
                </tr>`;
            });
        }
        html += '</tbody></table>';
        container.innerHTML = html;
    }

    // Show/hide toggle
    btn.addEventListener('click', () => {
        visible = !visible;
        if (visible) {
            container.style.display = 'block';
            btn.textContent = 'Hide Orders';
            // Load (or reload) orders with last search
            loadOrders(lastSearch);
        } else {
            container.style.display = 'none';
            btn.textContent = 'Show Orders';
        }
    });

    // Search (with button)
    searchBtn.addEventListener('click', () => {
        lastSearch = searchBox.value.trim();
        if (!visible) {
            visible = true;
            container.style.display = 'block';
            btn.textContent = 'Hide Orders';
        }
        loadOrders(lastSearch);
    });

    // Search (on enter key)
    searchBox.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            lastSearch = searchBox.value.trim();
            if (!visible) {
                visible = true;
                container.style.display = 'block';
                btn.textContent = 'Hide Orders';
            }
            loadOrders(lastSearch);
        }
    });
});



    </script>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeDeleteModal()">&times;</span>
            <div class="modal-header">
                <h3 class="modal-title">Confirm Delete</h3>
            </div>
            <div class="modal-body">
                Are you sure you want to delete employee <span id="employeeName"></span>?
                This action cannot be undone.
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeDeleteModal()">Cancel</button>
                <button class="btn btn-delete" onclick="deleteEmployee()">Delete</button>
            </div>
        </div>
    </div>
    
</body>
</html> 